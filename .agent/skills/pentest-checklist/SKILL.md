---
name: Lista de Verificación de Pentesting (Pentest Checklist)
description: Esta habilidad se utiliza para planificar pruebas de penetración, crear listas de verificación para evaluaciones de seguridad, preparar entornos de prueba, definir el alcance del pentesting y seguir las mejores prácticas en pruebas de seguridad web y de red. Proporciona una metodología estructurada para ejecuciones de pentesting profesionales.
metadata:
  author: zebbern
  version: "1.1"
---

# Lista de Verificación de Pentesting (Pentest Checklist)

## Propósito

Proporcionar una lista de verificación exhaustiva para la planificación, ejecución y seguimiento de pruebas de penetración. Asegurar una preparación minuciosa, un alcance adecuado y una remediación efectiva de las vulnerabilidades descubiertas.

## Entradas y Prerrequisitos

- Objetivos de negocio claros para las pruebas.
- Información sobre el entorno objetivo.
- Restricciones de presupuesto y tiempo.
- Contactos de las partes interesadas y autorización.
- Acuerdos legales y documentos de alcance.

## Resultados y Entregables

- Definición del alcance y objetivos del pentest.
- Entorno de prueba preparado.
- Datos de monitoreo de seguridad.
- Informe de hallazgos de vulnerabilidades.
- Plan de remediación y verificación.

---

## Flujo de Trabajo Principal

### Fase 1: Definición del Alcance

#### Definir Objetivos

- [ ] **Clarificar el propósito de la prueba** - Determinar los objetivos (encontrar vulnerabilidades, cumplimiento, aseguramiento para clientes).
- [ ] **Validar la necesidad del pentest** - Asegurarse de que una prueba de penetración es la solución adecuada.
- [ ] **Alinear los resultados con los objetivos** - Definir los criterios de éxito.

**Preguntas de Referencia:**
- ¿Por qué se realiza este pentest?
- ¿Qué resultados específicos se esperan?
- ¿Qué se hará con los hallazgos?

#### Conocer los Tipos de Prueba

| Tipo | Propósito | Alcance |
|------|---------|-------|
| Pentest Externo | Evaluar la superficie de ataque externa | Sistemas expuestos a Internet |
| Pentest Interno | Evaluar el riesgo de amenazas internas | Red interna |
| Aplicación Web | Encontrar vulnerabilidades en aplicaciones | Aplicaciones específicas |
| Ingeniería Social | Probar la seguridad humana | Empleados, procesos |
| Red Team | Simulación completa de adversario | Toda la organización |

#### Enumerar Amenazas Probables

- [ ] **Identificar áreas de alto riesgo** - ¿Dónde podría ocurrir el daño?
- [ ] **Evaluar la sensibilidad de los datos** - ¿Qué datos podrían verse comprometidos?
- [ ] **Revisar sistemas heredados (legacy)** - Los sistemas antiguos suelen tener vulnerabilidades.
- [ ] **Mapear activos críticos** - Priorizar los objetivos de la prueba.

#### Definir el Alcance

- [ ] **Listar sistemas dentro del alcance** - IPs, dominios, aplicaciones.
- [ ] **Definir ítems fuera del alcance** - Sistemas que se deben evitar.
- [ ] **Establecer límites de prueba** - ¿Qué técnicas están permitidas?
- [ ] **Documentar exclusiones** - Sistemas de terceros, datos de producción.

#### Planificación del Presupuesto

| Factor | Consideración |
|--------|---------------|
| Valor del Activo | Mayor valor = mayor inversión |
| Complejidad | Más sistemas = más tiempo |
| Profundidad Requerida| Pruebas exhaustivas cuestan más |
| Valor de Reputación | Empresas de renombre cuestan más |

**Verificación de la Realidad del Presupuesto:**
- Los pentests baratos suelen producir resultados pobres.
- Alinear el presupuesto con la criticidad de los activos.
- Considerar pruebas continuas vs. puntuales.

### Fase 2: Preparación del Entorno

#### Preparar el Entorno de Prueba

- [ ] **Decisión Producción vs. Staging** - Determinar dónde realizar las pruebas.
- [ ] **Establecer límites de prueba** - No realizar DoS en producción.
- [ ] **Programar la ventana de pruebas** - Minimizar el impacto en el negocio.
- [ ] **Crear cuentas de prueba** - Proporcionar niveles de acceso apropiados.

**Opciones de Entorno:**
- **Producción**: Realista pero arriesgado.
- **Staging**: Más seguro pero puede diferir de producción.
- **Clon**: Ideal pero consume recursos.

#### Realizar Escaneos Preliminares

- [ ] **Ejecutar escáneres de vulnerabilidades** - Encontrar problemas conocidos primero.
- [ ] **Corregir vulnerabilidades obvias** - No desperdiciar el tiempo del pentest.
- [ ] **Documentar problemas existentes** - Compartir con los evaluadores.

**Herramientas Comunes de Pre-escaneo:**
```bash
# Escaneo de vulnerabilidades de red
nmap -sV --script vuln OBJETIVO

# Escaneo de vulnerabilidades web
nikto -h http://OBJETIVO
```

#### Revisar la Política de Seguridad

- [ ] **Verificar requisitos de cumplimiento** - GDPR, PCI-DSS, HIPAA.
- [ ] **Documentar las reglas de manejo de datos** - Procedimientos para datos sensibles.
- [ ] **Confirmar la autorización legal** - Obtener permiso por escrito.

#### Notificar al Proveedor de Hosting

- [ ] **Consultar las políticas del proveedor** - ¿Qué pruebas están permitidas?
- [ ] **Enviar solicitudes de autorización** - Requisitos para AWS, Azure, GCP.
- [ ] **Documentar aprobaciones** - Mantener registros.

### Fase 3: Selección de Expertos

#### Encontrar Pentesters Cualificados

- [ ] **Buscar recomendaciones** - Consultar fuentes de confianza.
- [ ] **Verificar credenciales** - OSCP, GPEN, CEH, CREST.
- [ ] **Revisar referencias** - Hablar con clientes anteriores.
- [ ] **Emparejar la experiencia con el alcance** - Especialistas en web, red, móvil.

#### Definir la Metodología

- [ ] **Seleccionar el estándar de prueba** - PTES, OWASP, NIST.
- [ ] **Determinar el nivel de acceso** - Black box, gray box, white box.
- [ ] **Acordar las técnicas** - Pruebas manuales vs. automatizadas.
- [ ] **Establecer el calendario de comunicación** - Actualizaciones y escalamiento.

**Enfoques de Prueba:**

| Tipo | Nivel de Acceso | Simula |
|------|----------------|--------|
| Caja Negra (Black Box) | Sin información | Atacante externo |
| Caja Gris (Gray Box) | Acceso parcial | Insider con acceso limitado |
| Caja Blanca (White Box)| Acceso total | Insider / Auditoría detallada |

#### Definir el Formato del Informe

- [ ] **Revisar informes de muestra** - Asegurar que la calidad cumple las necesidades.
- [ ] **Especificar secciones requeridas** - Resumen ejecutivo, detalles técnicos.
- [ ] **Solicitar salida legible por máquina** - CSV, XML para seguimiento.
- [ ] **Acordar las escalas de riesgo** - CVSS, escala personalizada.

### Fase 4: Monitoreo

#### Implementar Monitoreo de Seguridad

- [ ] **Desplegar IDS/IPS** - Sistemas de detección de intrusos.
- [ ] **Habilitar el registro (logging)** - Pistas de auditoría exhaustivas.
- [ ] **Configurar SIEM** - Análisis de registros centralizado.
- [ ] **Configurar alertas** - Notificaciones en tiempo real.

#### Configurar el Registro (Logging)

- [ ] **Centralizar los registros** - Agregar desde todos los sistemas.
- [ ] **Establecer periodos de retención** - Mantener registros para análisis.
- [ ] **Habilitar registros detallados** - A nivel de aplicación y de sistema.
- [ ] **Probar la recolección de registros** - Verificar que todas las fuentes funcionan.

### Fase 5: Remediación

#### Asegurar Copias de Seguridad (Backups)

- [ ] **Verificar la integridad de las copias** - Probar la restauración.
- [ ] **Documentar procedimientos de recuperación** - Saber cómo restaurar.
- [ ] **Separar el acceso a las copias** - Protegerlas durante las pruebas.

#### Reservar Tiempo para la Remediación

- [ ] **Asignar disponibilidad al equipo** - Análisis post-pentest.
- [ ] **Programar la implementación de correcciones** - Abordar los hallazgos.
- [ ] **Planificar pruebas de verificación** - Confirmar que las correcciones funcionan.

#### Procedimiento de Limpieza

- [ ] **Eliminar artefactos de prueba** - Puertas traseras, scripts, archivos.
- [ ] **Eliminar cuentas de prueba** - Retirar el acceso de los evaluadores.
- [ ] **Restaurar configuraciones** - Volver al estado original.
- [ ] **Verificar limpieza completa** - Auditar todos los cambios.

---

## Referencia Rápida

### Lista de Verificación Pre-Pentest

```
□ Alcance definido y documentado
□ Autorización obtenida
□ Entorno preparado
□ Proveedor de hosting notificado
□ Equipo informado
□ Monitoreo habilitado
□ Copias de seguridad verificadas
```

### Lista de Verificación Post-Pentest

```
□ Informe recibido y revisado
□ Hallazgos priorizados
□ Remediación asignada
□ Correcciones implementadas
□ Pruebas de verificación programadas
□ Entorno limpio
□ Próxima prueba programada
```

## Restricciones

- Las pruebas en producción conllevan riesgos inherentes.
- Las limitaciones presupuestarias afectan la exhaustividad.
- Las restricciones de tiempo pueden limitar la cobertura.
- Los hallazgos pierden vigencia rápidamente.

---

## Solución de Problemas

| Problema | Solución |
|-------|----------|
| Aumento del alcance (Scope creep) | Documentar y requerir aprobación de cambios |
| Pruebas impactan producción | Programar en horas de baja actividad, usar staging |
| Hallazgos disputados | Proporcionar evidencia detallada, volver a probar |
| Remediación retrasada | Priorizar por riesgo, establecer plazos |
